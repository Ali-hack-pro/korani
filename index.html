<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تسجيل الحضور والغياب</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --absence-color: #e74c3c;
            --text-color: #333;
            --light-bg: #f9f9f9;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --btn-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
            transition: background 0.3s;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
        
        body {
            background: linear-gradient(-45deg, #f5f7fa, #c3cfe2, #a1c4fd, #f5f7fa);
            background-size: 400% 400%;
            animation: gradient 5s ease infinite;
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
        }
        
        .logo {
            height: 60px;
            margin-left: 15px;
        }
        
        .class-name {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
            background: #e8f4fc;
            padding: 8px 15px;
            border-radius: 20px;
            text-align: center;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .language-switcher {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: var(--btn-shadow);
        }
        
        .language-switcher:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .main-content {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: var(--shadow);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        input[type="text"]:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .buttons-container {
            display: flex;
            flex-direction: column;
            margin-top: 30px;
            gap: 15px;
        }
        
        .btn {
            display: inline-block;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            text-align: center;
            box-shadow: var(--btn-shadow);
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn-attendance {
            background-color: var(--primary-color);
        }
        
        .btn-attendance:hover {
            background-color: #2980b9;
        }
        
        .btn-absence {
            background-color: var(--absence-color);
        }
        
        .btn-absence:hover {
            background-color: #c0392b;
        }
        
        .attendance-list {
            margin-top: 30px;
            border-top: 1px solid #ddd;
            padding-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .attendance-list h2 {
            margin-bottom: 15px;
            color: var(--primary-color);
            position: sticky;
            top: 0;
            background: white;
            padding: 10px 0;
        }
        
        #attendanceRecords {
            list-style-type: none;
        }
        
        #attendanceRecords li {
            background-color: #f1f1f1;
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #attendanceRecords li:hover {
            transform: translateX(5px);
        }
        
        .attendance-item {
            background-color: var(--secondary-color) !important; /* لون جديد للحضور */
            color: white; /* لجعل النص واضحاً */
        }
        
        .absence-item {
            background-color: var(--absence-color) !important; /* لون جديد للغياب */
            color: white; /* لجعل النص واضحاً */
        }

        .attendance-item .timestamp, .absence-item .timestamp {
            color: rgba(255, 255, 255, 0.8) !important;
        }
        
        .timestamp {
            color: #777;
            font-size: 14px;
        }
        
        .student-name {
            font-weight: bold;
        }
        
        .empty-state {
            text-align: center;
            padding: 20px;
            color: #777;
            font-style: italic;
        }
        
        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 45px 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            box-shadow: var(--btn-shadow);
            z-index: 1000;
            animation: slideIn 0.5s ease, fadeOut 0.5s ease 2.5s forwards;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }
        
        .success {
            background-color: var(--secondary-color);
        }
        
        .error {
            background-color: var(--absence-color);
        }
        
        .loading {
            background-color: var(--primary-color);
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            width: 90%;
            max-width: 500px;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            font-size: 20px;
            color: var(--primary-color);
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #777;
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                text-align: center;
            }
            
            .logo-container {
                margin-bottom: 15px;
            }
            
            .header-controls {
                width: 100%;
                justify-content: center;
                margin-top: 10px;
            }
            
            .message {
                right: 10px;
                left: 10px;
                text-align: center;
            }
        }
        
        body[dir="ltr"] {
            text-align: left;
        }
        
        body[dir="ltr"] .logo {
            margin-left: 0;
            margin-right: 15px;
        }
        
        body[dir="ltr"] header {
            flex-direction: row-reverse;
        }
        
        body[dir="ltr"] #attendanceRecords li:hover {
            transform: translateX(-5px);
        }
        
        body[dir="ltr"] .message {
            right: auto;
            left: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <img src="https://korani.eu/img/logoar.png" alt="شعار الموقع" class="logo">
                <div class="class-name" id="className">الفصل: غير محدد</div>
            </div>
            <div class="header-controls">
                <button class="language-switcher" id="languageSwitcher">Deutsch</button>
            </div>
        </header>
        
        <div class="main-content">
            <form id="attendanceForm">
                <div class="form-group">
                    <label for="firstName" id="firstNameLabel">الاسم الأول</label>
                    <input type="text" id="firstName" required>
                </div>
                
                <div class="form-group">
                    <label for="lastName" id="lastNameLabel">الاسم الثاني</label>
                    <input type="text" id="lastName" required>
                </div>
                
                <div class="buttons-container">
                    <button type="submit" class="btn btn-attendance" id="submitBtn">تسجيل الحضور</button>
                    <button type="button" class="btn btn-absence" id="absenceBtn">تسجيل غياب</button>
                </div>
            </form>
            
            <div class="attendance-list">
                <h2 id="attendanceListTitle">سجل الحضور والغياب</h2>
                <ul id="attendanceRecords">
                    <li class="empty-state" id="emptyState">لم يتم تسجيل أي حضور أو غياب بعد</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="modal" id="absenceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">تسجيل غياب طالب</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <form id="absenceForm">
                <div class="form-group">
                    <label for="absenceFirstName" id="absenceFirstNameLabel">الاسم الأول</label>
                    <input type="text" id="absenceFirstName" required>
                </div>
                
                <div class="form-group">
                    <label for="absenceLastName" id="absenceLastNameLabel">الاسم الثاني</label>
                    <input type="text" id="absenceLastName" required>
                </div>
                
                <div class="buttons-container">
                    <button type="submit" class="btn btn-absence" id="absenceSubmitBtn">تسجيل الغياب</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // *** تأكد من تحديث هذا الرابط بعد نشر التطبيق الجديد (Publish -> Deploy as web app) ***
        const API_URL = 'https://script.google.com/macros/s/AKfycby58GdjjpPFXdmeqDwhomlvphVNY2_ycBQ59kWbZbxwcTsCTtJq-0D5tEp1mNHJnPQIXw/exec'; 
        
        const classes = {
            1: "معلمة جنين - الاثنين", 2: "معلمة احلام - الاثنين", 3: "معلمة ايات العدوي - الاثنين",
            4: "معلمة سمر - الاثنين", 5: "معلمة الاء زيادة - الاثنين", 6: "معلمة رانبا - الاثنين",
            7: "معلم عبادة الاشقر - الاثنين", 8: "معلمة اسماء السلطان - الاثنين", 9: "معلمة سناء - الاثنين",
            10: "معلمة فوزية - الخميس", 11: "معلمة ام عمر - الخميس", 12: "معلمة براء - الخميس",
            13: "معلمة ناريمان صالح - الخميس", 14: "معلم عثمان الخطيب - الخميس", 15: "معلمة .ام براء - الخميس",
            16: "معلمة مروة - الخميس", 17: "معلمة روان - الخميس", 18: "معلمة سمر - الخميس", 19: "معلمة سناء - الخميس",
            20: "معلمة شيماء - الجمعة", 21: "معلمة دانا - الجمعة", 22: "محمود دغميس - الجمعة",
            23: "معلمة أمامة أبو حطب - الجمعة", 24: "معلمة بسمة - الجمعة", 25: "معلمة ماريا - الجمعة",
            26: "احمد الشرقاوي - الجمعة", 27: "معلم احمد الشرقاوي - الاحد", 28: "معلمة يسرا السلطان - الاحد",
            29: "الشيخ عمار - الاحد", 30: "المعلمة ريعان عسقول - الخميس", 31: "الشيخ اسامة السلطان - الاحد",
            32: "الشيخ أمين - الاحد", 33: "المعلمة سناء - الاربعاء", 34: "المعلمة سناء - الاحد",
            35: "صف النورانية الاول - الخميس", 36: "صف النورانية الثاني - الخميس"
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('attendanceForm');
            const firstNameInput = document.getElementById('firstName');
            const lastNameInput = document.getElementById('lastName');
            const attendanceRecords = document.getElementById('attendanceRecords');
            const languageSwitcher = document.getElementById('languageSwitcher');
            const emptyState = document.getElementById('emptyState');
            const absenceBtn = document.getElementById('absenceBtn');
            const absenceModal = document.getElementById('absenceModal');
            const modalClose = document.getElementById('modalClose');
            const absenceForm = document.getElementById('absenceForm');
            const absenceFirstName = document.getElementById('absenceFirstName');
            const absenceLastName = document.getElementById('absenceLastName');
            const classNameElement = document.getElementById('className');
            
            const urlParams = new URLSearchParams(window.location.search);
            const classNumber = parseInt(urlParams.get('class'));
            
            let currentClass = 'غير محدد';
            let classId = classNumber;
            
            if (classNumber && classes[classNumber]) {
                currentClass = classes[classNumber];
            } else if (classNumber) {
                currentClass = `فصل ${classNumber}`;
            }
            
            classNameElement.textContent = `الفصل: ${currentClass}`;
            
            const texts = {
                ar: {
                    firstNameLabel: "الاسم الأول", lastNameLabel: "الاسم الثاني",
                    submitBtn: "تسجيل الحضور", absenceBtn: "تسجيل غياب",
                    attendanceListTitle: "سجل الحضور والغياب", languageBtn: "Deutsch",
                    emptyState: "لم يتم تسجيل أي حضور أو غياب بعد",
                    successMessage: "تم تسجيل حضور {name} بنجاح",
                    absenceSuccessMessage: "تم تسجيل غياب {name} بنجاح",
                    errorMessage: "يرجى ملء جميع الحقول",
                    modalTitle: "تسجيل غياب طالب",
                    className: `الفصل: ${currentClass}`
                },
                de: {
                    firstNameLabel: "Vorname", lastNameLabel: "Nachname",
                    submitBtn: "Anwesenheit registrieren", absenceBtn: "Abwesenheit registrieren",
                    attendanceListTitle: "Anwesenheits- und Abwesenheitsliste", languageBtn: "العربية",
                    emptyState: "Noch keine Anwesenheit oder Abwesenheit registriert",
                    successMessage: "Anwesenheit von {name} erfolgreich registriert",
                    absenceSuccessMessage: "Abwesenheit von {name} erfolgreich registriert",
                    errorMessage: "Bitte füllen Sie alle Felder aus",
                    modalTitle: "Abwesenheit eines Schülers registrieren",
                    className: `Klasse: ${currentClass}`
                }
            };
            
            const savedStudentName = getCookie('studentName');
            if (savedStudentName) {
                const names = savedStudentName.split(' ');
                firstNameInput.value = names[0] || '';
                lastNameInput.value = names[1] || '';
            }
            
            // جلب البيانات عند التحميل
            fetchAttendance();
            
            let currentLang = 'ar';
            
            languageSwitcher.addEventListener('click', function() {
                currentLang = currentLang === 'ar' ? 'de' : 'ar';
                updateLanguage(currentLang);
            });
            
            function updateLanguage(lang) {
                document.documentElement.lang = lang;
                document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                
                document.getElementById('firstNameLabel').textContent = texts[lang].firstNameLabel;
                document.getElementById('lastNameLabel').textContent = texts[lang].lastNameLabel;
                document.getElementById('submitBtn').textContent = texts[lang].submitBtn;
                document.getElementById('absenceBtn').textContent = texts[lang].absenceBtn;
                document.getElementById('attendanceListTitle').textContent = texts[lang].attendanceListTitle;
                document.getElementById('modalTitle').textContent = texts[lang].modalTitle;
                document.getElementById('absenceSubmitBtn').textContent = texts[lang].absenceBtn;
                document.getElementById('className').textContent = texts[lang].className;
                languageSwitcher.textContent = texts[lang].languageBtn;
                emptyState.textContent = texts[lang].emptyState;
                // يجب تحديث سجلات الحضور الموجودة باللغة الجديدة
                updateAttendanceRecordsLanguage(lang);
            }

            function updateAttendanceRecordsLanguage(lang) {
                const records = attendanceRecords.querySelectorAll('li:not(.empty-state)');
                records.forEach(li => {
                    const timestampSpan = li.querySelector('.timestamp');
                    if (timestampSpan) {
                        const isAttendance = li.classList.contains('attendance-item');
                        const statusText = isAttendance ? 
                            (lang === 'ar' ? 'حضور' : 'Anwesenheit') : 
                            (lang === 'ar' ? 'غياب' : 'Abwesenheit');
                        // نعتمد على أن النص الحالي هو: الوقت (الحالة)
                        timestampSpan.textContent = timestampSpan.textContent.replace(/\(([^)]+)\)$/, `(${statusText})`);
                    }
                });
            }

            
            absenceBtn.addEventListener('click', function() {
                // نقل الاسم الأول في حال كان موجوداً في حقل الحضور
                absenceFirstName.value = firstNameInput.value.trim();
                absenceLastName.value = lastNameInput.value.trim();

                absenceModal.style.display = 'flex';
            });
            
            modalClose.addEventListener('click', function() {
                absenceModal.style.display = 'none';
                absenceForm.reset();
            });
            
            window.addEventListener('click', function(event) {
                if (event.target === absenceModal) {
                    absenceModal.style.display = 'none';
                    absenceForm.reset();
                }
            });
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                // إضافة 'حضور' كحالة
                registerAttendance(firstNameInput.value.trim(), lastNameInput.value.trim(), 'حضور', true, 'attendance');
            });
            
            absenceForm.addEventListener('submit', function(e) {
                e.preventDefault();
                // إضافة 'غياب' كحالة
                registerAttendance(absenceFirstName.value.trim(), absenceLastName.value.trim(), 'غياب', false, 'absence');
                absenceModal.style.display = 'none';
                absenceForm.reset();
            });
            
            // تم تعديل الدالة لإضافة معامل "status"
            function registerAttendance(firstName, lastName, status, isMainStudent, type) {
                if (firstName && lastName) {
                    if (isMainStudent && type === 'attendance') {
                        setCookie('studentName', `${firstName} ${lastName}`, 30);
                    }
                    
                    const now = new Date();
                    const timeString = now.toLocaleString();
                    
                    showMessage(currentLang === 'ar' ? 
                        (type === 'attendance' ? 'جاري تسجيل الحضور...' : 'جاري تسجيل الغياب...') :
                        (type === 'attendance' ? 'Anwesenheit wird registriert...' : 'Abwesenheit wird registriert...'), 'loading');
                    
                    const classIdentifier = classId || currentClass;
                    
                    // تم إضافة &status= في الرابط
                    const url = `${API_URL}?action=add&first=${encodeURIComponent(firstName)}&second=${encodeURIComponent(lastName)}&class=${encodeURIComponent(classIdentifier)}&time=${encodeURIComponent(timeString)}&status=${encodeURIComponent(status)}`;
                    
                    fetch(url)
                    .then(response => response.json()) // التوقع أن يكون الرد JSON الآن
                    .then(result => {
                        console.log('API Response:', result);

                        if (result.status === "success") {
                            if (emptyState.style.display !== 'none') {
                                emptyState.style.display = 'none';
                            }
                            
                            const listItem = document.createElement('li');
                            // التمييز بين الحضور والغياب
                            const isAttendance = status === 'حضور';
                            listItem.className = isAttendance ? 'attendance-item' : 'absence-item';
                            
                            const statusDisplay = currentLang === 'ar' ? status : (isAttendance ? 'Anwesenheit' : 'Abwesenheit');
                            
                            listItem.innerHTML = `
                                <span class="student-name">${firstName} ${lastName}</span>
                                <span class="timestamp">${timeString} (${statusDisplay})</span>
                            `;
                            
                            // إضافة السجل الجديد في البداية
                            attendanceRecords.prepend(listItem);
                            
                            if (isMainStudent && type === 'attendance') {
                                // مسح الاسم الثاني فقط إذا كان التسجيل حضوراً من النموذج الرئيسي
                                lastNameInput.value = '';
                            }
                            
                            const successMessage = type === 'attendance' ? texts[currentLang].successMessage : texts[currentLang].absenceSuccessMessage;
                            showMessage(successMessage.replace('{name}', `${firstName} ${lastName}`), 'success');
                            
                            // لا داعي لجلب كل السجلات بعد الإضافة الناجحة، فقط يتم إضافتها محلياً
                            // fetchAttendance(); // تم إيقافها لتجنب الجلب المكرر
                        } else {
                             // في حال وجود خطأ من السيرفر
                            throw new Error(result.message || "فشل التسجيل");
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        showMessage(currentLang === 'ar' ? 
                            `خطأ: ${error.message || (type === 'attendance' ? 'فشل تسجيل الحضور' : 'فشل تسجيل الغياب')}` :
                            `Fehler: ${error.message || (type === 'attendance' ? 'Fehler bei der Anwesenheitsregistrierung' : 'Fehler bei der Abwesenheitsregistrierung')}`, 'error');
                    });
                } else {
                    showMessage(texts[currentLang].errorMessage, 'error');
                }
            }
            
            // تم تعديل الدالة لعرض حالة الحضور/الغياب
            function fetchAttendance() {
                const url = `${API_URL}?action=get`;
                
                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Fetched data:', data);
                        
                        const classIdentifier = classId || currentClass;
                        // التصفية بناءً على 'class'
                        const classData = data.filter(item => {
                            // مقارنة القيم مع تحويلها إلى سلسلة نصية لضمان المطابقة
                            return String(item.class) === String(classIdentifier);
                        });
                        
                        // ترتيب البيانات: الأحدث أولاً
                        classData.sort((a, b) => new Date(b.time) - new Date(a.time));


                        attendanceRecords.innerHTML = ''; // تفريغ القائمة الحالية

                        if (classData.length > 0) {
                            emptyState.style.display = 'none';
                            
                            classData.forEach(student => {
                                const listItem = document.createElement('li');
                                
                                const isAttendance = student.attendance === 'حضور';
                                listItem.className = isAttendance ? 'attendance-item' : 'absence-item';
                                
                                const statusDisplay = currentLang === 'ar' ? student.attendance : (isAttendance ? 'Anwesenheit' : 'Abwesenheit');

                                listItem.innerHTML = `
                                    <span class="student-name">${student.first} ${student.second}</span>
                                    <span class="timestamp">${student.time} (${statusDisplay})</span>
                                `;
                                attendanceRecords.appendChild(listItem);
                            });
                        } else {
                            // إضافة Empty State مرة أخرى إذا لم تكن هناك بيانات بعد تفريغ القائمة
                            attendanceRecords.appendChild(emptyState);
                            emptyState.style.display = 'block';
                            emptyState.textContent = texts[currentLang].emptyState;
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                        // في حالة وجود خطأ في الجلب، عرض رسالة الخطأ في Empty State
                        attendanceRecords.innerHTML = '';
                        attendanceRecords.appendChild(emptyState);
                        emptyState.textContent = currentLang === 'ar' ? 
                            'خطأ في تحميل البيانات: حاول مرة أخرى.' : 'Fehler beim Laden der Daten: Versuchen Sie es erneut.';
                        emptyState.style.display = 'block';
                    });
            }
            
            function showMessage(message, type) {
                const existingMessage = document.querySelector('.message');
                if (existingMessage) {
                    existingMessage.remove();
                }
                
                const messageElement = document.createElement('div');
                messageElement.className = `message ${type}`;
                messageElement.textContent = message;
                
                const closeBtn = document.createElement('button');
                closeBtn.className = 'close-btn';
                closeBtn.innerHTML = '&times;';
                closeBtn.addEventListener('click', function() {
                    messageElement.remove();
                });
                
                messageElement.appendChild(closeBtn);
                document.body.appendChild(messageElement);
                
                setTimeout(() => {
                    if (messageElement.parentNode) {
                        messageElement.remove();
                    }
                }, 3000);
            }
            
            function setCookie(name, value, days) {
                const d = new Date();
                d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
                const expires = "expires=" + d.toUTCString();
                document.cookie = name + "=" + value + ";" + expires + ";path=/";
            }
            
            function getCookie(name) {
                const cookieName = name + "=";
                const decodedCookie = decodeURIComponent(document.cookie);
                const cookieArray = decodedCookie.split(';');
                
                for(let i = 0; i < cookieArray.length; i++) {
                    let cookie = cookieArray[i];
                    while (cookie.charAt(0) === ' ') {
                        cookie = cookie.substring(1);
                    }
                    if (cookie.indexOf(cookieName) === 0) {
                        return cookie.substring(cookieName.length, cookie.length);
                    }
                }
                return "";
            }

            // تهيئة اللغة عند التحميل إذا كانت هناك لغة محفوظة
            const savedLang = 'ar'; // يمكنك استخدام كوكي لحفظ اللغة
            updateLanguage(savedLang); 
        });
    </script>
</body>
</html>
